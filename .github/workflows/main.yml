name: Story to Video Pro
on:
  workflow_dispatch:
    inputs:
      story:
        description: 'اكتب قصتك هنا'
        required: true
        default: 'هذه قصة قصيرة عن المغامرة'

jobs:
  make-video:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      
      - name: Install Video Tools
        run: |
          pip install moviepy gtts
          sudo apt-get install ffmpeg

      - name: Create Video File
        run: |
          python - <<EOF
          from gtts import gTTS
          from moviepy.editor import TextClip, ColorClip, CompositeVideoClip
          import os

          # 1. تحويل القصة لصوت (عشان يصير فيديو بجد)
          text = "${{ github.event.inputs.story }}"
          tts = gTTS(text=text, lang='ar')
          tts.save("voice.mp3")

          # 2. صناعة فيديو بسيط (خلفية سوداء مع نص)
          # ملاحظة: GitHub Actions ما يدعم الخطوط العربية بسهولة، لذا سنصنع فيديو بالصوت حالياً
          # وإذا تبي صورة، البوت بيسوي لك خلفية ملونة
          
          clip = ColorClip(size=(720, 1280), color=(50, 50, 50), duration=5)
          clip.write_videofile("final_video.mp4", fps=24)
          EOF

      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: my-final-video
          path: final_video.mp4
